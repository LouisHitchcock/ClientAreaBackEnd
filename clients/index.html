<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Client Gallery</title>
  <script type="module">
    // Firebase setup
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    import { firebaseConfig } from "../config/firebase-config.js";

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const urlParams = new URLSearchParams(window.location.search);
    const slug = urlParams.get("slug");


    let clientData;

    async function loadClient() {
      if (!slug) {
        document.getElementById("app").innerHTML = "<p>No client specified.</p>";
        return;
      }

      const docRef = doc(db, "clients", slug);
      const docSnap = await getDoc(docRef);

      if (docSnap.exists()) {
        clientData = docSnap.data();
        document.getElementById("auth").style.display = "block";
      } else {
        document.getElementById("app").innerHTML = "<p>Client not found.</p>";
      }
    }

    window.checkPassword = function () {
      const input = document.getElementById("password-input").value;
      const error = document.getElementById("error-msg");

      if (input === clientData.password) {
        document.getElementById("auth").style.display = "none";
        showGallery();
      } else {
        error.textContent = "Incorrect password. Try again.";
      }
    };

    function showGallery() {
      const content = document.getElementById("content");

      content.innerHTML = `
        <div style="display: flex; align-items: center; gap: 2rem; flex-wrap: wrap;">
          <img src="${clientData.heroImage}" alt="Hero Image" style="width: 300px; height: 300px; object-fit: cover; border-radius: 25px;" />

          <div>
            <p><strong>Title:</strong> ${clientData.title}</p>
            <p><strong>Date:</strong> ${clientData.date}</p>
            <p><strong>Location:</strong> ${clientData.location}</p>
            <a href="${clientData.driveLink}" target="_blank">
              <button style="
                padding: 10px 20px;
                border-radius: 15px;
                border: 2px solid black;
                background: white;
                cursor: pointer;
                margin-top: 1rem;
              ">Click Me</button>
            </a>
          </div>
        </div>
      `;

      content.style.display = "block";
    }


    loadClient();
  </script>
</head>
<body>
  <div id="app">
    <div id="auth" style="display:none;">
      <h2>This page is password protected</h2>
      <input type="password" id="password-input" placeholder="Enter password" />
      <button onclick="checkPassword()">Submit</button>
      <p id="error-msg" style="color:red;"></p>
    </div>

    <div id="content" style="display:none;">
      <h1 id="title"></h1>
      <div id="gallery"></div>
    </div>
  </div>
</body>
</html>
